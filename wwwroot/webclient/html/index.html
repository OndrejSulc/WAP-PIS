<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Management calendar</title>
    <!-- Login management -->

    <script src="/lib/signalr/signalr.min.js"></script>
    <script src="/webclient/js/meeting.js"></script>
    <script src="/webclient/js/notification.js"></script>
    <script src="/webclient/js/userAvailability.js"></script>
    <script src="/webclient/js/userManagement.js"></script>
    <script src="/webclient/js/signalr.js"></script>
    <script src="/webclient/js/login.js"></script>

    <!-- Calendar management -->
    <!-- CSS-->
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <script src='https://kit.fontawesome.com/a076d05399.js' crossorigin='anonymous'></script>
    <link rel="stylesheet" type="text/css" href="/webclient/js/tui.calendar-1.15.3/tui-calendar.css" />
    <link rel="stylesheet" type="text/css" href="https://uicdn.toast.com/tui.time-picker/latest/tui-time-picker.css">
    <link rel="stylesheet" type="text/css" href="https://uicdn.toast.com/tui.date-picker/latest/tui-date-picker.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/webclient/css/calendar.css" />
    <link rel="stylesheet" type="text/css" href="/webclient/css/user_management.css" />
    <!-- JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
            crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/gh/cferdinandi/smooth-scroll@15.0.0/dist/smooth-scroll.polyfills.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="https://uicdn.toast.com/tui.code-snippet/v1.5.2/tui-code-snippet.min.js"></script>
    <script src="https://uicdn.toast.com/tui.time-picker/v2.0.3/tui-time-picker.min.js"></script>
    <script src="https://uicdn.toast.com/tui.date-picker/v4.0.3/tui-date-picker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chance/1.0.13/chance.min.js"></script>
    <script src="/webclient/js/tui.calendar-1.15.3/tui-calendar.js"></script>
    <script src="/webclient/js/calendar.js" defer></script>
</head>
<body>


    <script>
        var logged_user_result, logger_user;
        logged_user_result = checkLogout();

        logged_user_result.then(function (result) {
            if (result.role == "Ceo" || result.role == "CeoSecretary") {
                document.getElementById('div_group_meeting_man_view').style.display = "block";
                load_users();
            }
            else {
                document.getElementById('div_group_meeting_man_view').style.display = "none";
            }
            document.getElementById('logged_user_role').value = result.role;
        });

    </script>

    <nav class="navbar" id="nav-menu">
        <a class="navbar-href" href="index.html">
            <span class="span-name">Calendar</span>
            <span>
                <i class="fa fa-hospital-o profile-img" style="font-size: 100px;color: white;"></i>
            </span>
        </a>
        <button class="nav-button" type="button" onclick="showMenu()" id="menu-button">
        </button>
        <div id="main-menu">
            <ul class="nav-ul" style="list-style: none;">
                <li class="nav-li">
                    <a class="nav-li-a active" href="#calendar-navigation" id="li-about">Calendar</a>
                </li>
                <!--<li class="nav-li">
                    <a class="nav-li-a" href="#calendar" id="li-int">Notification</a>
                </li>-->
                <li class="nav-li">
                    <a class="nav-li-a" href="#userManagement" id="li-int">User Management</a>
                </li>
                <li class="nav-li">
                    <a id="sign_out" onclick="logout();" class="nav-li-a buttons"><i class="fas fa-sign-out-alt" style="color: white;font-size: 20px;"></i></a>
                </li>
            </ul>
        </div>
    </nav>


    <div class="container">

        <div id="calendar-navigation">
            <h1>Calendar</h1>
            <a id="prev_button" onclick="calendar.prev();setMonth();" href="#" class="buttons previous round">&#8249;</a>
            <pre id="actual_month"></pre>
            <a id="next_button" onclick="calendar.next();setMonth();" href="#" class="buttons next round">&#8250;</a>
        </div>

        <div id="calendar" class="section"></div>
        <input type="hidden" id="logged_user_role" value="">

        <div id="userManagement" class="section">
            <h1>UserManagement</h1><button onclick="createNewUser()"> Create New User</button>

            <table>
                <thead>
                    <tr>
                        <th>Role</th>
                        <th>Firstname</th>
                        <th>Surname</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="user_management">
                </tbody>
            </table>
        </div>

        <div id="notifications_div" class="section">
            <h1>Notifications</h1>

            <table>
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Meet. Title</th>
                        <th>Meet. Description</th>
                        <th>Meet. From</th>
                        <th>Meet. Until</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="notifications">
                </tbody>
            </table>
        </div>


    </div>

    <div id="modal_view" style="display: none;">
        <div class="tui-full-calendar-popup-container">
            <div class="tui-full-calendar-popup-section">
                <span id="owner_man_view" style="font-size: 24px;"></span>
            </div>
            <div class="tui-full-calendar-popup-section">
                <span id="title_man_view" style="font-size: 24px;"></span>
            </div>
            <div class="tui-full-calendar-popup-section">
                <i class="fa fa-calendar"></i><span id="date_time_man_view"></span>
            </div>
            <div id="attendees_div_man_view">
                <div class="tui-full-calendar-popup-section">
                    <i class="fa fa-users"></i><span id="attendees_man_view"></span>
                </div>
            </div>
            <div class="tui-full-calendar-popup-section">
                <i class="fa fa-note"></i><span id="description_man_view"></span>
            </div>
            <button onclick="hideManagerMeeting()" class="tui-full-calendar-button tui-full-calendar-popup-close"><span class="tui-full-calendar-icon tui-full-calendar-ic-close"></span></button>
            <div  id="control_buttons" class="tui-full-calendar-popup-section">
                <input type="hidden" id="calendar_id_man_view">
                <input type="hidden" id="meeting_id_man_view">
                <button class="save_button" onclick="editManagerMeeting()"><span>Edit</span></button>
                <button class="save_button" onclick="deleteManagerMeeting()"><span>Delete</span></button>
            </div>

        </div>
    </div>

    <div id="modal_edit" style="display: none;">
        <div class="tui-full-calendar-popup-container">
            <div class="tui-full-calendar-popup-section">
                <label for="title_man_view" class="modal_view_label">Title:  </label><input id="title_man_view" class="tui-full-calendar-content modal_inputs" placeholder="Subject" value="Title" type="text">
            </div>
            <div class="tui-full-calendar-popup-section">
                <label for="start_date_man_view" class="modal_view_label">Start:  </label><input id="start_date_man_view" class="tui-full-calendar-content modal_inputs" placeholder="Start date" type="datetime-local" value="">
            </div>
            <div class="tui-full-calendar-popup-section">
                <label for="end_date_man_view" class="modal_view_label">End:  </label><input id="end_date_man_view" class="tui-full-calendar-content modal_inputs" placeholder="End date" type="datetime-local" value="">
            </div>
            <div id="div_group_meeting_man_view">
                <div class="tui-full-calendar-popup-section" id="group_meeting">
                    <label for="group_meeting_man_view" class="modal_view_label">Group meeting: </label>
                    <input id="group_meeting_man_view" class="groupCheck" type="checkbox" onchange="checkGroupMeeting()">
                    <select name="group_meeting_attendees" id="group_meeting_attendees" style="display: none;" size="3" multiple></select>
                </div>
            </div>
            <div class="tui-full-calendar-popup-section">
                <label for="description_man_view" class="modal_view_label">Description:  </label>
            </div>
            <div class="tui-full-calendar-popup-section">
                <textarea name="description_man_view" id="description_man_view" cols="30" rows="3" class="modal_inputs">Description</textarea>
            </div>
            <button onclick="hideManagerMeeting()" class="tui-full-calendar-button tui-full-calendar-popup-close"><span class="tui-full-calendar-icon tui-full-calendar-ic-close"></span></button>
            <br>
            <div class="tui-full-calendar-popup-section">
                <input type="hidden" id="calendar_id_man_view">
                <input type="hidden" id="meeting_id_man_view">
                <div id="man_meeting_view">
                    <button class="save_button" onclick="saveManagerMeeting()"><span>Save</span></button><button class="save_button" onclick="deleteManagerMeeting()"><span>Delete</span></button>
                </div>
                <div id="man_meeting_create">
                    <button class="save_button" onclick="createManagerMeeting()"><span>Create</span></button>
                </div>
            </div>

        </div>
    </div>

    <div id="create_user_view" style="display: none;">
        <div class="tui-full-calendar-popup-container">
            <h3>Create New User</h3>
            <div class="tui-full-calendar-popup-section">
                <label for="um_login" class="modal_view_label">Login:  </label><input id="um_login" class="tui-full-calendar-content modal_inputs" placeholder="Login" type="text">
            </div>
            <div class="tui-full-calendar-popup-section">
                <label for="um_password" class="modal_view_label">Password:  </label><input id="um_password" class="tui-full-calendar-content modal_inputs" placeholder="Password" type="text">
            </div>
            <div class="tui-full-calendar-popup-section">
                <label for="um_name" class="modal_view_label">Name:  </label><input id="um_name" class="tui-full-calendar-content modal_inputs" placeholder="User Name" type="text">
            </div>
            <div class="tui-full-calendar-popup-section">
                <label for="um_surname" class="modal_view_label">Surname:  </label><input id="um_surname" class="tui-full-calendar-content modal_inputs" placeholder="User Surname" type="text">
            </div>
            <div class="tui-full-calendar-popup-section">
                <label for="um_date_of_birth" class="modal_view_label">Date of birth:  </label><input id="um_date_of_birth" class="tui-full-calendar-content modal_inputs" type="date">
            </div>
            <div id="um_secretary_div">
                <div class="tui-full-calendar-popup-section" id="group_meeting">
                    <input id="um_issecretary" class="tui-full-calendar-content modal_inputs" type="checkbox" onchange="checkSecretary()">
                    <label for="um_issecretary" class="modal_view_label">Secretary</label><br>
                    <select name="secretary_attendees" id="secretary_attendees" style="display: none;" size="1"></select>
                </div>
            </div>
            <button onclick="hideUser()" class="tui-full-calendar-button tui-full-calendar-popup-close"><span class="tui-full-calendar-icon tui-full-calendar-ic-close"></span></button>
            <br>
            <div class="tui-full-calendar-popup-section">
                <!--<div id="user_view">
                    <input type="hidden" id="um_user_id">
                    <button class="save_button" onclick="saveUser()"><span>Save</span></button><button class="save_button" onclick="deleteUser()"><span>Delete</span></button>
                </div>-->
                <div id="user_create">
                    <button class="save_button" onclick="saveNewUser()"><span>Create</span></button>
                </div>
            </div>

        </div>
    </div>
    <script src="/lib/jquery/dist/jquery.min.js"></script>
</body>
</html> 
<!--<button><i class='fas fa-caret-square-left'></i></button>-->
<!--const boxes = document.getElementsByClassName('tui-full-calendar-weekday-schedule-title');

    boxes.forEach(box => {
    box.addEventListener('click', function handleClick(event) {
        console.log('box clicked', event);

        //box.setAttribute('style', 'background-color: yellow;');
    });
    });*/
    /*var spans = document.getElementsByClassName('tui-full-calendar-weekday-schedule-title');
    for(i=0;i<spans.length;i++)
        spans[i].onclick=showManagerMeeting();
    */
    /*function doSomething() 
    {
        console.log('box clicked');
    }-->